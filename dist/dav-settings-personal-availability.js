/*! For license information please see dav-settings-personal-availability.js.LICENSE.txt */
(()=>{var a,e={19271:(a,e,n)=>{"use strict";var i=n(20144),o=n(9944),l=n(51796),d=n(16453),r=n(64024),s=n(81063),A=n(4820),c=n(56580),p=n.n(c),u=n(79753),v=n(22200);const b=p()((t=>(A.default.defaults.headers["X-Requested-With"]="XMLHttpRequest",s.getPatcher().patch("request",A.default),s.createClient((0,u.generateRemoteUrl)("dav/".concat(t,"/").concat((0,v.getCurrentUser)().uid)))))),C=(0,n(17499).IY)().setApp("dav").detectUser().build();var y=n(7582),m=n(55586),x=n.n(m),g=n(10861),f=n.n(g),h=n(20571),w=n.n(h),k=n(13299),B=n.n(k),S=n(31144),_=n.n(S),D=n(25108);const O={name:"Availability",components:{NcButton:f(),NcCheckboxRadioSwitch:w(),CalendarAvailability:l.Dx,NcSettingsSection:B(),NcTimezonePicker:_()},data(){const t=x().determine();return{loading:!0,saving:!1,timezone:t?t.name():"UTC",slots:{MO:[],TU:[],WE:[],TH:[],FR:[],SA:[],SU:[]},automated:"yes"===(0,d.loadState)("dav","user_status_automation")}},async mounted(){try{const t=await async function(){var t,a,e;const n=b("calendars"),i=await n.customRequest("inbox",{method:"PROPFIND",data:'<?xml version="1.0"?>\n\t\t\t<x0:propfind xmlns:x0="DAV:">\n\t\t\t  <x0:prop>\n\t\t\t\t<x1:calendar-availability xmlns:x1="urn:ietf:params:xml:ns:caldav"/>\n\t\t\t  </x0:prop>\n\t\t\t</x0:propfind>'}),o=await(0,y.parseXML)(i.data);if(!o)return;const d=null==o||null===(t=o.multistatus)||void 0===t||null===(a=t.response[0])||void 0===a||null===(e=a.propstat)||void 0===e?void 0:e.prop["calendar-availability"];return d?(0,l.Xg)(d):void 0}();if(t){const{slots:a,timezoneId:e}=t;this.slots=a,e&&(this.timezone=e),D.info("availability loaded",this.slots,this.timezoneId)}else D.info("no availability is set"),this.slots={MO:[],TU:[],WE:[],TH:[],FR:[],SA:[],SU:[]}}catch(a){D.error("could not load existing availability",a),(0,r.x2)(t("dav","Failed to load availability"))}finally{this.loading=!1}},methods:{async save(){try{this.saving=!0,await async function(t,a){const e=[...Object.keys(t).flatMap((a=>t[a].map((t=>({...t,day:a})))))],n=(0,l.ST)(e,a);C.debug("New availability ical created",{vavailability:n});const i=b("calendars");await i.customRequest("inbox",{method:"PROPPATCH",data:'<?xml version="1.0"?>\n\t\t\t<x0:propertyupdate xmlns:x0="DAV:">\n\t\t\t  <x0:set>\n\t\t\t\t<x0:prop>\n\t\t\t\t  <x1:calendar-availability xmlns:x1="urn:ietf:params:xml:ns:caldav">'.concat(n,"</x1:calendar-availability>\n\t\t\t\t</x0:prop>\n\t\t\t  </x0:set>\n\t\t\t</x0:propertyupdate>")})}(this.slots,this.timezone),this.automated?await async function(){return await A.default.post((0,u.generateOcsUrl)("/apps/provisioning_api/api/v1/config/users/{appId}/{configKey}",{appId:"dav",configKey:"user_status_automation"}),{configValue:"yes"})}():await async function(){return await A.default.delete((0,u.generateOcsUrl)("/apps/provisioning_api/api/v1/config/users/{appId}/{configKey}",{appId:"dav",configKey:"user_status_automation"}))}(),(0,r.s$)(t("dav","Saved availability"))}catch(a){D.error("could not save availability",a),(0,r.x2)(t("dav","Failed to save availability"))}finally{this.saving=!1}}}};var E=n(93379),$=n.n(E),T=n(7795),z=n.n(T),P=n(90569),U=n.n(P),R=n(3565),I=n.n(R),N=n(19216),j=n.n(N),F=n(44589),M=n.n(F),q=n(69110),Z={};Z.styleTagTransform=M(),Z.setAttributes=I(),Z.insert=U().bind(null,"head"),Z.domAPI=z(),Z.insertStyleElement=j(),$()(q.Z,Z),q.Z&&q.Z.locals&&q.Z.locals;const W=(0,n(51900).Z)(O,(function(){var t=this,a=t._self._c;return a("NcSettingsSection",{attrs:{title:t.$t("dav","Availability"),description:t.$t("dav","If you configure your working hours, other users will see when you are out of office when they book a meeting.")}},[a("div",{staticClass:"time-zone"},[a("strong",[t._v("\n\t\t\t"+t._s(t.$t("dav","Time zone:"))+"\n\t\t")]),t._v(" "),a("span",{staticClass:"time-zone-text"},[a("NcTimezonePicker",{model:{value:t.timezone,callback:function(a){t.timezone=a},expression:"timezone"}})],1)]),t._v(" "),a("CalendarAvailability",{attrs:{slots:t.slots,loading:t.loading,"l10n-to":t.$t("dav","to"),"l10n-delete-slot":t.$t("dav","Delete slot"),"l10n-empty-day":t.$t("dav","No working hours set"),"l10n-add-slot":t.$t("dav","Add slot"),"l10n-monday":t.$t("dav","Monday"),"l10n-tuesday":t.$t("dav","Tuesday"),"l10n-wednesday":t.$t("dav","Wednesday"),"l10n-thursday":t.$t("dav","Thursday"),"l10n-friday":t.$t("dav","Friday"),"l10n-saturday":t.$t("dav","Saturday"),"l10n-sunday":t.$t("dav","Sunday")},on:{"update:slots":function(a){t.slots=a}}}),t._v(" "),a("NcCheckboxRadioSwitch",{attrs:{checked:t.automated},on:{"update:checked":function(a){t.automated=a}}},[t._v("\n\t\t"+t._s(t.$t("dav",'Automatically set user status to "Do not disturb" outside of availability to mute all notifications.'))+"\n\t")]),t._v(" "),a("NcButton",{attrs:{disabled:t.loading||t.saving,type:"primary"},on:{click:t.save}},[t._v("\n\t\t"+t._s(t.$t("dav","Save"))+"\n\t")])],1)}),[],!1,null,"e90bacba",null).exports;i.ZP.prototype.$t=o.translate,new(i.ZP.extend(W))({}).$mount("#settings-personal-availability")},69110:(t,a,e)=>{"use strict";e.d(a,{Z:()=>d});var n=e(87537),i=e.n(n),o=e(23645),l=e.n(o)()(i());l.push([t.id,".availability-day[data-v-e90bacba]{padding:0 10px 0 10px;position:absolute}.availability-slots[data-v-e90bacba]{display:flex;white-space:nowrap}.availability-slot[data-v-e90bacba]{display:flex;flex-direction:row;align-items:center}.availability-slot-group[data-v-e90bacba]{display:flex;flex-direction:column}[data-v-e90bacba] .mx-input-wrapper{width:85px}[data-v-e90bacba] .mx-datepicker{width:97px}[data-v-e90bacba] .multiselect{border:1px solid var(--color-border-dark);width:120px}.time-zone[data-v-e90bacba]{padding:32px 12px 12px 0}.grid-table[data-v-e90bacba]{display:grid;margin-bottom:32px;grid-column-gap:24px;grid-row-gap:6px;grid-template-columns:min-content min-content min-content}.button[data-v-e90bacba]{align-self:flex-end}.label-weekday[data-v-e90bacba]{position:relative;display:inline-flex;padding-top:4px}.delete-slot[data-v-e90bacba]{background-color:rgba(0,0,0,0);border:none;padding-bottom:12px;opacity:.5}.delete-slot[data-v-e90bacba]:hover{opacity:1}.add-another[data-v-e90bacba]{background-color:rgba(0,0,0,0);border:none;opacity:.5;display:inline-flex;padding:0;margin:0;margin-bottom:3px}.add-another[data-v-e90bacba]:hover{opacity:1}.to-text[data-v-e90bacba]{padding-right:12px}.time-zone-text[data-v-e90bacba]{padding-left:22px}.empty-content[data-v-e90bacba]{color:var(--color-text-lighter);margin-top:4px}","",{version:3,sources:["webpack://./apps/dav/src/views/Availability.vue"],names:[],mappings:"AACA,mCACC,qBAAA,CACA,iBAAA,CAED,qCACC,YAAA,CACA,kBAAA,CAED,oCACC,YAAA,CACA,kBAAA,CACA,kBAAA,CAED,0CACC,YAAA,CACA,qBAAA,CAED,oCACC,UAAA,CAED,iCACC,UAAA,CAED,+BACC,yCAAA,CACA,WAAA,CAED,4BACC,wBAAA,CAED,6BACC,YAAA,CACA,kBAAA,CACA,oBAAA,CACA,gBAAA,CACA,yDAAA,CAED,yBACC,mBAAA,CAED,gCACC,iBAAA,CACA,mBAAA,CACA,eAAA,CAED,8BACC,8BAAA,CACA,WAAA,CACA,mBAAA,CACA,UAAA,CACA,oCACC,SAAA,CAIF,8BACC,8BAAA,CACA,WAAA,CACA,UAAA,CACA,mBAAA,CACA,SAAA,CACA,QAAA,CACA,iBAAA,CAEA,oCACC,SAAA,CAGF,0BACC,kBAAA,CAED,iCACC,iBAAA,CAED,gCACC,+BAAA,CACA,cAAA",sourcesContent:["\n.availability-day {\n\tpadding: 0 10px 0 10px;\n\tposition: absolute;\n}\n.availability-slots {\n\tdisplay: flex;\n\twhite-space: nowrap;\n}\n.availability-slot {\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n}\n.availability-slot-group {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n::v-deep .mx-input-wrapper {\n\twidth: 85px;\n}\n::v-deep .mx-datepicker {\n\twidth: 97px;\n}\n::v-deep .multiselect {\n\tborder: 1px solid var(--color-border-dark);\n\twidth: 120px;\n}\n.time-zone {\n\tpadding: 32px 12px 12px 0;\n}\n.grid-table {\n\tdisplay: grid;\n\tmargin-bottom: 32px;\n\tgrid-column-gap: 24px;\n\tgrid-row-gap: 6px;\n\tgrid-template-columns: min-content min-content min-content;\n}\n.button {\n\talign-self: flex-end;\n}\n.label-weekday {\n\tposition: relative;\n\tdisplay: inline-flex;\n\tpadding-top: 4px;\n}\n.delete-slot {\n\tbackground-color: transparent;\n\tborder: none;\n\tpadding-bottom: 12px;\n\topacity: .5;\n\t&:hover {\n\t\topacity: 1;\n\t}\n}\n\n.add-another {\n\tbackground-color: transparent;\n\tborder: none;\n\topacity: .5;\n\tdisplay: inline-flex;\n\tpadding: 0;\n\tmargin: 0;\n\tmargin-bottom: 3px;\n\n\t&:hover {\n\t\topacity: 1;\n\t}\n}\n.to-text {\n\tpadding-right: 12px;\n}\n.time-zone-text{\n\tpadding-left: 22px;\n}\n.empty-content {\n\tcolor: var(--color-text-lighter);\n\tmargin-top: 4px;\n}\n\n"],sourceRoot:""}]);const d=l},69862:()=>{},40964:()=>{}},n={};function i(t){var a=n[t];if(void 0!==a)return a.exports;var o=n[t]={id:t,loaded:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.m=e,i.amdD=function(){throw new Error("define cannot be used indirect")},i.amdO={},a=[],i.O=(t,e,n,o)=>{if(!e){var l=1/0;for(A=0;A<a.length;A++){e=a[A][0],n=a[A][1],o=a[A][2];for(var d=!0,r=0;r<e.length;r++)(!1&o||l>=o)&&Object.keys(i.O).every((t=>i.O[t](e[r])))?e.splice(r--,1):(d=!1,o<l&&(l=o));if(d){a.splice(A--,1);var s=n();void 0!==s&&(t=s)}}return t}o=o||0;for(var A=a.length;A>0&&a[A-1][2]>o;A--)a[A]=a[A-1];a[A]=[e,n,o]},i.n=t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return i.d(a,{a}),a},i.d=(t,a)=>{for(var e in a)i.o(a,e)&&!i.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:a[e]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,a)=>Object.prototype.hasOwnProperty.call(t,a),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),i.j=3347,(()=>{i.b=document.baseURI||self.location.href;var t={3347:0};i.O.j=a=>0===t[a];var a=(a,e)=>{var n,o,l=e[0],d=e[1],r=e[2],s=0;if(l.some((a=>0!==t[a]))){for(n in d)i.o(d,n)&&(i.m[n]=d[n]);if(r)var A=r(i)}for(a&&a(e);s<l.length;s++)o=l[s],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return i.O(A)},e=self.webpackChunknextcloud=self.webpackChunknextcloud||[];e.forEach(a.bind(null,0)),e.push=a.bind(null,e.push.bind(e))})(),i.nc=void 0;var o=i.O(void 0,[7874],(()=>i(19271)));o=i.O(o)})();
//# sourceMappingURL=dav-settings-personal-availability.js.map?v=ec6f178ed219a8083ebb