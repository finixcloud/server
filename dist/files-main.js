/*! For license information please see files-main.js.LICENSE.txt */
(()=>{"use strict";var e,i={47320:(e,i,n)=>{var a=n(17499),r=n(79954),o=n(31352),s=n(79753),l=n(45994);const d=function(){var t,e,i,n;const a=(null===(t=OCA)||void 0===t||null===(e=t.Files)||void 0===e||null===(i=e.App)||void 0===i||null===(n=i.currentFileList)||void 0===n?void 0:n.dirInfo)||{path:"/",name:""};return"".concat(a.path,"/").concat(a.name).replace(/\/\//gi,"/")};var c=n(4820),p=n(20144),u=n(62520),g=n(64024),m=n(93455),v=n.n(m),h=n(70110),f=n.n(h);const A=256,w={name:"TemplatePreview",inheritAttrs:!1,props:{basename:{type:String,required:!0},checked:{type:Boolean,default:!1},fileid:{type:[String,Number],required:!0},filename:{type:String,required:!0},previewUrl:{type:String,default:null},hasPreview:{type:Boolean,default:!0},mime:{type:String,required:!0},ratio:{type:Number,default:null}},data:()=>({failedPreview:!1}),computed:{nameWithoutExt(){return this.basename.indexOf(".")>-1?this.basename.split(".").slice(0,-1).join("."):this.basename},id(){return"template-picker-".concat(this.fileid)},realPreviewUrl(){return this.failedPreview&&this.mimeIcon?this.mimeIcon:this.previewUrl?this.previewUrl:(0,l.ts)()?(0,s.generateUrl)("/core/preview?fileId=".concat(this.fileid,"&x=").concat(A,"&y=").concat(A,"&a=1")):(0,s.generateUrl)("/apps/files_sharing/publicpreview/".concat(document.getElementById("sharingToken")&&document.getElementById("sharingToken").value,"?fileId=").concat(this.fileid,"&file=").concat(function(t){const e=(t.startsWith("/")?t:"/".concat(t)).split("/");let i="";return e.forEach((t=>{""!==t&&(i+="/"+encodeURIComponent(t))})),i}(this.filename),"&x=").concat(A,"&y=").concat(A,"&a=1"))},mimeIcon(){return OC.MimeType.getIconUrl(this.mime)}},methods:{onCheck(){this.$emit("check",this.fileid)},onFailure(){this.failedPreview=!0}}},C=w;var b=n(93379),y=n.n(b),_=n(7795),k=n.n(_),S=n(90569),x=n.n(S),E=n(3565),N=n.n(E),P=n(19216),O=n.n(P),F=n(44589),T=n.n(F),I=n(87027),U={};U.styleTagTransform=T(),U.setAttributes=N(),U.insert=x().bind(null,"head"),U.domAPI=k(),U.insertStyleElement=O(),y()(I.Z,U),I.Z&&I.Z.locals&&I.Z.locals;var j=n(51900);const B=(0,j.Z)(C,(function(){var t=this,e=t._self._c;return e("li",{staticClass:"template-picker__item"},[e("input",{staticClass:"radio",attrs:{id:t.id,type:"radio",name:"template-picker"},domProps:{checked:t.checked},on:{change:t.onCheck}}),t._v(" "),e("label",{staticClass:"template-picker__label",attrs:{for:t.id}},[e("div",{staticClass:"template-picker__preview",class:t.failedPreview?"template-picker__preview--failed":""},[e("img",{staticClass:"template-picker__image",attrs:{src:t.realPreviewUrl,alt:"",draggable:"false"},on:{error:t.onFailure}})]),t._v(" "),e("span",{staticClass:"template-picker__title"},[t._v("\n\t\t\t"+t._s(t.nameWithoutExt)+"\n\t\t")])])])}),[],!1,null,"440aea22",null).exports;var D=n(25108);const q={name:"TemplatePicker",components:{NcEmptyContent:v(),NcModal:f(),TemplatePreview:B},props:{logger:{type:Object,required:!0}},data:()=>({checked:-1,loading:!1,name:null,opened:!1,provider:null}),computed:{nameWithoutExt(){return this.name.indexOf(".")>-1?this.name.split(".").slice(0,-1).join("."):this.name},emptyTemplate(){var e,i;return{basename:t("files","Blank"),fileid:-1,filename:this.t("files","Blank"),hasPreview:!1,mime:(null===(e=this.provider)||void 0===e?void 0:e.mimetypes[0])||(null===(i=this.provider)||void 0===i?void 0:i.mimetypes)}},selectedTemplate(){return this.provider.templates.find((t=>t.fileid===this.checked))},style(){return{"--margin":"8px","--width":"160px","--border":"2px","--fullwidth":"180px","--height":this.provider.ratio?Math.round(160/this.provider.ratio)+"px":null}}},methods:{async open(t,e){this.checked=this.emptyTemplate.fileid,this.name=t,this.provider=e;const i=(await async function(){return(await c.default.get((0,s.generateOcsUrl)("apps/files/api/v1/templates"))).data.ocs.data}()).find((t=>t.app===e.app&&t.label===e.label));if(null===i)throw new Error("Failed to match provider in results");this.provider=i,0!==i.templates.length?this.opened=!0:this.onSubmit()},close(){this.checked=this.emptyTemplate.fileid,this.loading=!1,this.name=null,this.opened=!1,this.provider=null},onCheck(t){this.checked=t},async onSubmit(){var t,e,i;this.loading=!0;const n=d(),a=null===(t=OCA)||void 0===t||null===(e=t.Files)||void 0===e||null===(i=e.App)||void 0===i?void 0:i.currentFileList;var r,o;this.nameWithoutExt===this.name&&(this.logger.debug("Fixed invalid filename",{name:this.name,extension:null===(r=this.provider)||void 0===r?void 0:r.extension}),this.name=this.name+(null===(o=this.provider)||void 0===o?void 0:o.extension));try{var l,p;const t=await async function(t,e,i){return(await c.default.post((0,s.generateOcsUrl)("apps/files/api/v1/templates/create"),{filePath:t,templatePath:e,templateType:i})).data.ocs.data}((0,u.normalize)("".concat(n,"/").concat(this.name)),null===(l=this.selectedTemplate)||void 0===l?void 0:l.filename,null===(p=this.selectedTemplate)||void 0===p?void 0:p.templateType);this.logger.debug("Created new file",t);const e=await(null==a?void 0:a.addAndFetchFileInfo(this.name).then(((t,e)=>e))),i=new OCA.Files.FileInfoModel(e,{filesClient:null==a?void 0:a.filesClient}),r=OCA.Files.fileActions.getDefaultFileAction(t.mime,"file",OC.PERMISSION_ALL);r&&r.action(t.basename,{$file:null==a?void 0:a.findFileEl(this.name),dir:n,fileList:a,fileActions:null==a?void 0:a.fileActions,fileInfoModel:i}),this.close()}catch(t){this.logger.error("Error while creating the new file from template"),D.error(t),(0,g.x2)(this.t("files","Unable to create new file from template"))}finally{this.loading=!1}}}};var Z=n(74502),L={};L.styleTagTransform=T(),L.setAttributes=N(),L.insert=x().bind(null,"head"),L.domAPI=k(),L.insertStyleElement=O(),y()(Z.Z,L),Z.Z&&Z.Z.locals&&Z.Z.locals;const V=(0,j.Z)(q,(function(){var t=this,e=t._self._c;return t.opened?e("NcModal",{staticClass:"templates-picker",attrs:{"clear-view-delay":-1,size:"normal"},on:{close:t.close}},[e("form",{staticClass:"templates-picker__form",style:t.style,on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.onSubmit.apply(null,arguments)}}},[e("h2",[t._v(t._s(t.t("files","Pick a template for {name}",{name:t.nameWithoutExt})))]),t._v(" "),e("ul",{staticClass:"templates-picker__list"},[e("TemplatePreview",t._b({attrs:{checked:t.checked===t.emptyTemplate.fileid},on:{check:t.onCheck}},"TemplatePreview",t.emptyTemplate,!1)),t._v(" "),t._l(t.provider.templates,(function(i){return e("TemplatePreview",t._b({key:i.fileid,attrs:{checked:t.checked===i.fileid,ratio:t.provider.ratio},on:{check:t.onCheck}},"TemplatePreview",i,!1))}))],2),t._v(" "),e("div",{staticClass:"templates-picker__buttons"},[e("button",{on:{click:t.close}},[t._v("\n\t\t\t\t"+t._s(t.t("files","Cancel"))+"\n\t\t\t")]),t._v(" "),e("input",{staticClass:"primary",attrs:{type:"submit","aria-label":t.t("files","Create a new file with the selected template")},domProps:{value:t.t("files","Create")}})])]),t._v(" "),t.loading?e("NcEmptyContent",{staticClass:"templates-picker__loading",attrs:{icon:"icon-loading"}},[t._v("\n\t\t"+t._s(t.t("files","Creating file"))+"\n\t")]):t._e()],1):t._e()}),[],!1,null,"55dd9121",null).exports,M=(0,a.IY)().setApp("files").detectUser().build();p.ZP.mixin({methods:{t:o.Iu,n:o.uN}});const Q=document.createElement("div");Q.id="template-picker",document.body.appendChild(Q);let W=(0,r.j)("files","templates",[]),R=(0,r.j)("files","templates_path",!1);M.debug("Templates providers",W),M.debug("Templates folder",{templatesPath:R});const z=new(p.ZP.extend(V))({name:"TemplatePicker",propsData:{logger:M}});z.$mount("#template-picker"),window.addEventListener("DOMContentLoaded",(function(){if(!R){M.debug("Templates folder not initialized");const t={attach(t){t.addMenuEntry({id:"template-init",displayName:(0,o.Iu)("files","Set up templates folder"),templateName:(0,o.Iu)("files","Templates"),iconClass:"icon-template-add",fileType:"file",actionHandler(e){G(e),t.removeMenuEntry("template-init")}})}};OC.Plugins.register("OCA.Files.NewFileMenu",t)}})),W.forEach(((t,e)=>{const i={attach(i){const n=i.fileList;"files"!==n.id&&"files.public"!==n.id||i.addMenuEntry({id:"template-new-".concat(t.app,"-").concat(e),displayName:t.label,templateName:t.label+t.extension,iconClass:t.iconClass||"icon-file",fileType:"file",actionHandler(e){z.open(e,t)}})}};OC.Plugins.register("OCA.Files.NewFileMenu",i)}));const G=async function(t){const e=(d()+"/".concat(t)).replace("//","/");try{M.debug("Initializing the templates directory",{templatePath:e});const t=await c.default.post((0,s.generateOcsUrl)("apps/files/api/v1/templates/path"),{templatePath:e,copySystemTemplates:!0});OCA.Files.App.currentFileList.changeDirectory(e,!0,!0),W=t.data.ocs.data.templates,R=t.data.ocs.data.template_path}catch(t){M.error("Unable to initialize the templates directory"),(0,g.x2)((0,o.Iu)("files","Unable to initialize the templates directory"))}};var $=n(78595);!function(){const t={attach(t){(0,$.Ld)("nextcloud:unified-search.search",(e=>{let{query:i}=e;t.setFilter(i)})),(0,$.Ld)("nextcloud:unified-search.reset",(()=>{this.query=null,t.setFilter("")}))}};window.OC.Plugins.register("OCA.Files.FileList",t)}();const Y=(0,a.IY)().setApp("files").detectUser().build(),H=function(t){let{id:e,name:i,order:n,icon:a,parent:r,classes:o="",expanded:s,params:l}=t;OCP.Files.Navigation.register({id:e,name:i,order:n,params:l,parent:r,expanded:!0===s,iconClass:a?"icon-".concat(a):"nav-icon-"+e,legacy:!0,sticky:o.includes("pinned")})};var K=n(41487),J=n.n(K);function X(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const tt=class{constructor(){X(this,"_views",[]),X(this,"_currentView",null),Y.debug("Navigation service initialized")}register(t){try{it(t),et(t,this._views)}catch(e){throw e instanceof Error&&Y.error(e.message,{view:t}),e}t.legacy&&Y.warn("Legacy view detected, please migrate to Vue"),t.iconClass&&(t.legacy=!0),this._views.push(t)}get views(){return this._views}setActive(t){this._currentView=t}get active(){return this._currentView}},et=function(t,e){if(e.find((e=>e.id===t.id)))throw new Error("Navigation id ".concat(t.id," is already registered"));return!0},it=function(t){if(!t.id||"string"!=typeof t.id)throw new Error("Navigation id is required and must be a string");if(!t.name||"string"!=typeof t.name)throw new Error("Navigation name is required and must be a string");if(!t.legacy){if(!t.getFiles||"function"!=typeof t.getFiles)throw new Error("Navigation getFiles is required and must be a function");if(!t.icon||"string"!=typeof t.icon||!J()(t.icon))throw new Error("Navigation icon is required and must be a valid svg string")}if(!("order"in t)||"number"!=typeof t.order)throw new Error("Navigation order is required and must be a number");if(t.columns&&t.columns.forEach(nt),t.emptyView&&"function"!=typeof t.emptyView)throw new Error("Navigation emptyView must be a function");if(t.parent&&"string"!=typeof t.parent)throw new Error("Navigation parent must be a string");if("sticky"in t&&"boolean"!=typeof t.sticky)throw new Error("Navigation sticky must be a boolean");if("expanded"in t&&"boolean"!=typeof t.expanded)throw new Error("Navigation expanded must be a boolean");return!0},nt=function(t){if(!t.id||"string"!=typeof t.id)throw new Error("Column id is required");if(!t.title||"string"!=typeof t.title)throw new Error("Column title is required");if(!t.property||"string"!=typeof t.property)throw new Error("Column property is required");if(t.sortFunction&&"function"!=typeof t.sortFunction)throw new Error("Column sortFunction must be a function");if(t.summary&&"function"!=typeof t.summary)throw new Error("Column summary must be a function");return!0};var at=n(57638),rt=n(55209),ot=n.n(rt),st=n(14032),lt=n.n(st),dt=n(91770),ct=n(28615),pt=n(74184),ut=n(48959),gt=n.n(ut);const mt={name:"NavigationQuota",components:{ChartPie:pt.Z,NcAppNavigationItem:lt(),NcProgressBar:gt()},data:()=>({loadingStorageStats:!1,storageStats:(0,r.j)("files","storageStats",null)}),computed:{storageStatsTitle(){var t,e,i;const n=(0,dt.sS)(null===(t=this.storageStats)||void 0===t?void 0:t.used),a=(0,dt.sS)(null===(e=this.storageStats)||void 0===e?void 0:e.quota);return(null===(i=this.storageStats)||void 0===i?void 0:i.quota)<0?this.t("files","{usedQuotaByte} used",{usedQuotaByte:n}):this.t("files","{used} of {quota} used",{used:n,quota:a})},storageStatsTooltip(){return this.storageStats.relative?this.t("files","{relative}% used",this.storageStats):""}},beforeMount(){setInterval(this.throttleUpdateStorageStats,6e4),(0,$.Ld)("files:file:created",this.throttleUpdateStorageStats),(0,$.Ld)("files:file:deleted",this.throttleUpdateStorageStats),(0,$.Ld)("files:file:moved",this.throttleUpdateStorageStats),(0,$.Ld)("files:file:updated",this.throttleUpdateStorageStats),(0,$.Ld)("files:folder:created",this.throttleUpdateStorageStats),(0,$.Ld)("files:folder:deleted",this.throttleUpdateStorageStats),(0,$.Ld)("files:folder:moved",this.throttleUpdateStorageStats),(0,$.Ld)("files:folder:updated",this.throttleUpdateStorageStats)},methods:{debounceUpdateStorageStats:(0,ct.D)(200,(function(t){this.updateStorageStats(t)})),throttleUpdateStorageStats:(0,ct.P)(1e3,(function(t){this.updateStorageStats(t)})),async updateStorageStats(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!this.loadingStorageStats){this.loadingStorageStats=!0;try{var i;const t=await c.default.get((0,s.generateUrl)("/apps/files/api/v1/stats"));if(null==t||null===(i=t.data)||void 0===i||!i.data)throw new Error("Invalid storage stats");this.storageStats=t.data.data}catch(i){Y.error("Could not refresh storage stats",{error:i}),e&&(0,g.x2)(t("files","Could not refresh storage stats"))}finally{this.loadingStorageStats=!1}}},t:o.Iu}};var vt=n(358),ht={};ht.styleTagTransform=T(),ht.setAttributes=N(),ht.insert=x().bind(null,"head"),ht.domAPI=k(),ht.insertStyleElement=O(),y()(vt.Z,ht),vt.Z&&vt.Z.locals&&vt.Z.locals;const ft=(0,j.Z)(mt,(function(){var t=this,e=t._self._c;return t.storageStats?e("NcAppNavigationItem",{staticClass:"app-navigation-entry__settings-quota",class:{"app-navigation-entry__settings-quota--not-unlimited":t.storageStats.quota>=0},attrs:{"aria-label":t.t("files","Storage informations"),loading:t.loadingStorageStats,name:t.storageStatsTitle,title:t.storageStatsTooltip,"data-cy-files-navigation-settings-quota":""},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.debounceUpdateStorageStats.apply(null,arguments)}}},[e("ChartPie",{attrs:{slot:"icon",size:20},slot:"icon"}),t._v(" "),t.storageStats.quota>=0?e("NcProgressBar",{attrs:{slot:"extra",error:t.storageStats.relative>80,value:Math.min(t.storageStats.relative,100)},slot:"extra"}):t._e()],1):t._e()}),[],!1,null,"26c061ec",null).exports;var At=n(68988),wt=n.n(At),Ct=n(16809),bt=n.n(Ct),yt=n(20571),_t=n.n(yt),kt=n(70386),St=n(36029),xt=n.n(St);const Et={name:"Setting",props:{el:{type:Function,required:!0}},mounted(){this.$el.appendChild(this.el())}},Nt=(0,j.Z)(Et,(function(){return(0,this._self._c)("div")}),[],!1,null,null,null).exports,Pt=(0,r.j)("files","config",{show_hidden:!1,crop_image_previews:!0}),Ot={name:"Settings",components:{Clipboard:kt.Z,NcAppSettingsDialog:wt(),NcAppSettingsSection:bt(),NcCheckboxRadioSwitch:_t(),NcInputField:xt(),Setting:Nt},props:{open:{type:Boolean,default:!1}},data(){var t,e,i,n;return{...Pt,settings:(null===(t=window.OCA)||void 0===t||null===(e=t.Files)||void 0===e||null===(i=e.Settings)||void 0===i?void 0:i.settings)||[],webdavUrl:(0,s.generateRemoteUrl)("dav/files/"+encodeURIComponent(null===(n=(0,l.ts)())||void 0===n?void 0:n.uid)),webdavDocs:"https://docs.nextcloud.com/server/stable/go.php?to=user-webdav",webdavUrlCopied:!1}},beforeMount(){this.settings.forEach((t=>t.open()))},beforeDestroy(){this.settings.forEach((t=>t.close()))},methods:{onClose(){this.$emit("close")},setConfig(t,e){(0,$.j8)("files:config:updated",{key:t,value:e}),c.default.post((0,s.generateUrl)("/apps/files/api/v1/config/"+t),{value:e})},async copyCloudId(){document.querySelector("input#webdav-url-input").select(),navigator.clipboard?(await navigator.clipboard.writeText(this.webdavUrl),this.webdavUrlCopied=!0,(0,g.s$)(t("files","WebDAV URL copied to clipboard")),setTimeout((()=>{this.webdavUrlCopied=!1}),5e3)):(0,g.x2)(t("files","Clipboard is not available"))},t:o.Iu}},Ft=Ot,Tt=(0,j.Z)(Ft,(function(){var t=this,e=t._self._c;return e("NcAppSettingsDialog",{attrs:{open:t.open,"show-navigation":!0,title:t.t("files","Files settings")},on:{"update:open":t.onClose}},[e("NcAppSettingsSection",{attrs:{id:"settings",title:t.t("files","Files settings")}},[e("NcCheckboxRadioSwitch",{attrs:{checked:t.show_hidden},on:{"update:checked":[function(e){t.show_hidden=e},function(e){return t.setConfig("show_hidden",e)}]}},[t._v("\n\t\t\t"+t._s(t.t("files","Show hidden files"))+"\n\t\t")]),t._v(" "),e("NcCheckboxRadioSwitch",{attrs:{checked:t.crop_image_previews},on:{"update:checked":[function(e){t.crop_image_previews=e},function(e){return t.setConfig("crop_image_previews",e)}]}},[t._v("\n\t\t\t"+t._s(t.t("files","Crop image previews"))+"\n\t\t")])],1),t._v(" "),0!==t.settings.length?e("NcAppSettingsSection",{attrs:{id:"more-settings",title:t.t("files","Additional settings")}},[t._l(t.settings,(function(t){return[e("Setting",{key:t.name,attrs:{el:t.el}})]}))],2):t._e(),t._v(" "),e("NcAppSettingsSection",{attrs:{id:"webdav",title:t.t("files","WebDAV")}},[e("NcInputField",{attrs:{id:"webdav-url-input","show-trailing-button":!0,success:t.webdavUrlCopied,"trailing-button-label":t.t("files","Copy to clipboard"),value:t.webdavUrl,readonly:"readonly",type:"url"},on:{focus:function(t){return t.target.select()},"trailing-button-click":t.copyCloudId},scopedSlots:t._u([{key:"trailing-button-icon",fn:function(){return[e("Clipboard",{attrs:{size:20}})]},proxy:!0}])}),t._v(" "),e("em",[e("a",{attrs:{href:t.webdavDocs,target:"_blank",rel:"noreferrer noopener"}},[t._v("\n\t\t\t\t"+t._s(t.t("files","Use this address to access your Files via WebDAV"))+" ↗\n\t\t\t")])])],1)],1)}),[],!1,null,"54b74cff",null).exports;const It={name:"Navigation",components:{Cog:at.default,NcAppNavigation:ot(),NcAppNavigationItem:lt(),SettingsModal:Tt,NavigationQuota:ft},props:{Navigation:{type:tt,required:!0}},data:()=>({settingsOpened:!1}),computed:{currentViewId(){var t,e;return(null===(t=this.$route)||void 0===t||null===(e=t.params)||void 0===e?void 0:e.view)||"files"},currentView(){return this.views.find((t=>t.id===this.currentViewId))},views(){return this.Navigation.views},parentViews(){return this.views.filter((t=>!t.parent)).sort(((t,e)=>t.order-e.order))},childViews(){return this.views.filter((t=>!!t.parent)).reduce(((t,e)=>(t[e.parent]=[...t[e.parent]||[],e],t[e.parent].sort(((t,e)=>t.order-e.order)),t)),{})}},watch:{currentView(t,e){Y.debug("View changed",{id:t.id,view:t}),this.showView(t,e)}},beforeMount(){this.currentView&&(Y.debug("Navigation mounted. Showing requested view",{view:this.currentView}),this.showView(this.currentView)),(0,$.Ld)("files:legacy-navigation:changed",this.onLegacyNavigationChanged)},methods:{showView(t,e){var i,n,a,r,o;if(null===(i=window)||void 0===i||null===(n=i.OCA)||void 0===n||null===(a=n.Files)||void 0===a||null===(r=a.Sidebar)||void 0===r||null===(o=r.close)||void 0===o||o.call(r),t.legacy){const e=document.querySelector("#app-content #app-content-"+this.currentView.id+".viewcontainer");document.querySelectorAll("#app-content .viewcontainer").forEach((t=>{t.classList.add("hidden")})),e.classList.remove("hidden");const{dir:i="/"}=OC.Util.History.parseUrlQuery(),n={itemId:t.id,dir:i};Y.debug("Triggering legacy navigation event",n),window.jQuery(e).trigger(new window.jQuery.Event("show",n)),window.jQuery(e).trigger(new window.jQuery.Event("urlChanged",n))}this.Navigation.setActive(t),function(t){const e=document.getElementById("page-heading-level-1");e&&(e.textContent=t)}(t.name),(0,$.j8)("files:navigation:changed",t)},onLegacyNavigationChanged(){let{id:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:"files"};const e=this.Navigation.views.find((e=>e.id===t));e&&e.legacy&&e.id!==this.currentView.id&&(this.$router.replace({...this.$route,params:{view:e.id}}),this.Navigation.setActive(e),this.showView(e))},onToggleExpand(t){t.expanded=!t.expanded,c.default.post((0,s.generateUrl)("/apps/files/api/v1/toggleShowFolder/".concat(t.id)),{show:t.expanded})},generateToNavigation(t){if(t.params){const{dir:e,fileid:i}=t.params;return{name:"filelist",params:t.params,query:{dir:e,fileid:i}}}return{name:"filelist",params:{view:t.id}}},openSettings(){this.settingsOpened=!0},onSettingsClose(){this.settingsOpened=!1},t:o.Iu}},Ut=It;var jt=n(19994),Bt={};Bt.styleTagTransform=T(),Bt.setAttributes=N(),Bt.insert=x().bind(null,"head"),Bt.domAPI=k(),Bt.insertStyleElement=O(),y()(jt.Z,Bt),jt.Z&&jt.Z.locals&&jt.Z.locals;const Dt=(0,j.Z)(Ut,(function(){var t=this,e=t._self._c;return e("NcAppNavigation",{attrs:{"data-cy-files-navigation":""},scopedSlots:t._u([{key:"list",fn:function(){return t._l(t.parentViews,(function(i){return e("NcAppNavigationItem",{key:i.id,attrs:{"allow-collapse":!0,"data-cy-files-navigation-item":i.id,icon:i.iconClass,open:i.expanded,pinned:i.sticky,title:i.name,to:t.generateToNavigation(i)},on:{"update:open":function(e){return t.onToggleExpand(i)}}},t._l(t.childViews[i.id],(function(i){return e("NcAppNavigationItem",{key:i.id,attrs:{"data-cy-files-navigation-item":i.id,exact:!0,icon:i.iconClass,title:i.name,to:t.generateToNavigation(i)}})})),1)}))},proxy:!0},{key:"footer",fn:function(){return[e("ul",{staticClass:"app-navigation-entry__settings"},[e("NavigationQuota"),t._v(" "),e("NcAppNavigationItem",{attrs:{"aria-label":t.t("files","Open the files app settings"),title:t.t("files","Files settings"),"data-cy-files-navigation-settings-button":""},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openSettings.apply(null,arguments)}}},[e("Cog",{attrs:{slot:"icon",size:20},slot:"icon"})],1)],1)]},proxy:!0}])},[t._v(" "),t._v(" "),e("SettingsModal",{attrs:{open:t.settingsOpened,"data-cy-files-navigation-settings":""},on:{close:t.onSettingsClose}})],1)}),[],!1,null,"622bb1e3",null).exports;var qt=n(25108);function Zt(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Lt=n(78345),Vt=n(17563);p.ZP.use(Lt.Z);const Mt=new Lt.Z({mode:"history",base:(0,s.generateUrl)("/apps/files",""),linkActiveClass:"active",routes:[{path:"/",alias:"/files"},{path:"/:view/:fileid?",name:"filelist",props:!0}],stringifyQuery(t){const e=(0,Vt.stringify)(t).replace(/%2F/gim,"/");return e?"?"+e:""}});var Qt,Wt;window.OCA.Files=null!==(Qt=window.OCA.Files)&&void 0!==Qt?Qt:{},window.OCP.Files=null!==(Wt=window.OCP.Files)&&void 0!==Wt?Wt:{};const Rt=new tt;Object.assign(window.OCP.Files,{Navigation:Rt});const zt=new class{constructor(){var t,e,i;t=this,i=void 0,(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e="_settings"))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,this._settings=[],qt.debug("OCA.Files.Settings initialized")}register(t){return this._settings.filter((e=>e.name===t.name)).length>0?(qt.error("A setting with the same name is already registered"),!1):(this._settings.push(t),!0)}get settings(){return this._settings}};Object.assign(window.OCA.Files,{Settings:zt}),Object.assign(window.OCA.Files.Settings,{Setting:class{constructor(t,e){let{el:i,open:n,close:a}=e;Zt(this,"_close",void 0),Zt(this,"_el",void 0),Zt(this,"_name",void 0),Zt(this,"_open",void 0),this._name=t,this._el=i,this._open=n,this._close=a,"function"!=typeof this._open&&(this._open=()=>{}),"function"!=typeof this._close&&(this._close=()=>{})}get name(){return this._name}get el(){return this._el}get open(){return this._open}get close(){return this._close}}}),new(p.ZP.extend(Dt))({name:"FilesNavigationRoot",propsData:{Navigation:Rt},router:Mt}).$mount("#app-navigation-files"),function(){const t=Object.values((0,r.j)("files","navigation",{}));t.length>0&&(Y.debug("Legacy files views detected. Processing...",t),t.forEach((t=>{H(t),t.sublist&&t.sublist.forEach((e=>H({...e,parent:t.id})))})))}()},358:(t,e,i)=>{i.d(e,{Z:()=>s});var n=i(87537),a=i.n(n),r=i(23645),o=i.n(r)()(a());o.push([t.id,".app-navigation-entry__settings-quota--not-unlimited[data-v-26c061ec] .app-navigation-entry__title{margin-top:-4px}.app-navigation-entry__settings-quota progress[data-v-26c061ec]{position:absolute;bottom:10px;margin-left:44px;width:calc(100% - 44px - 22px)}","",{version:3,sources:["webpack://./apps/files/src/components/NavigationQuota.vue"],names:[],mappings:"AAIC,mGACC,eAAA,CAGD,gEACC,iBAAA,CACA,WAAA,CACA,gBAAA,CACA,8BAAA",sourcesContent:["\n// User storage stats display\n.app-navigation-entry__settings-quota {\n\t// Align title with progress and icon\n\t&--not-unlimited::v-deep .app-navigation-entry__title {\n\t\tmargin-top: -4px;\n\t}\n\n\tprogress {\n\t\tposition: absolute;\n\t\tbottom: 10px;\n\t\tmargin-left: 44px;\n\t\twidth: calc(100% - 44px - 22px);\n\t}\n}\n"],sourceRoot:""}]);const s=o},87027:(t,e,i)=>{i.d(e,{Z:()=>s});var n=i(87537),a=i.n(n),r=i(23645),o=i.n(r)()(a());o.push([t.id,".template-picker__item[data-v-440aea22]{display:flex}.template-picker__label[data-v-440aea22]{display:flex;align-items:center;flex:1 1;flex-direction:column}.template-picker__label[data-v-440aea22],.template-picker__label *[data-v-440aea22]{cursor:pointer;user-select:none}.template-picker__label[data-v-440aea22]::before{display:none !important}.template-picker__preview[data-v-440aea22]{display:block;overflow:hidden;flex:1 1;width:var(--width);min-height:var(--height);max-height:var(--height);padding:0;border:var(--border) solid var(--color-border);border-radius:var(--border-radius-large)}input:checked+label>.template-picker__preview[data-v-440aea22]{border-color:var(--color-primary)}.template-picker__preview--failed[data-v-440aea22]{display:flex}.template-picker__image[data-v-440aea22]{max-width:100%;background-color:var(--color-main-background);object-fit:cover}.template-picker__preview--failed .template-picker__image[data-v-440aea22]{width:calc(var(--margin)*8);margin:auto;background-color:rgba(0,0,0,0) !important;object-fit:initial}.template-picker__title[data-v-440aea22]{overflow:hidden;max-width:calc(var(--width) + 4px);padding:var(--margin);white-space:nowrap;text-overflow:ellipsis}","",{version:3,sources:["webpack://./apps/files/src/components/TemplatePreview.vue"],names:[],mappings:"AAGC,wCACC,YAAA,CAGD,yCACC,YAAA,CAEA,kBAAA,CACA,QAAA,CACA,qBAAA,CAEA,oFACC,cAAA,CACA,gBAAA,CAGD,iDACC,uBAAA,CAIF,2CACC,aAAA,CACA,eAAA,CAEA,QAAA,CACA,kBAAA,CACA,wBAAA,CACA,wBAAA,CACA,SAAA,CACA,8CAAA,CACA,wCAAA,CAEA,+DACC,iCAAA,CAGD,mDAEC,YAAA,CAIF,yCACC,cAAA,CACA,6CAAA,CAEA,gBAAA,CAID,2EACC,2BAAA,CAEA,WAAA,CACA,yCAAA,CAEA,kBAAA,CAGD,yCACC,eAAA,CAEA,kCAAA,CACA,qBAAA,CACA,kBAAA,CACA,sBAAA",sourcesContent:["\n\n.template-picker {\n\t&__item {\n\t\tdisplay: flex;\n\t}\n\n\t&__label {\n\t\tdisplay: flex;\n\t\t// Align in the middle of the grid\n\t\talign-items: center;\n\t\tflex: 1 1;\n\t\tflex-direction: column;\n\n\t\t&, * {\n\t\t\tcursor: pointer;\n\t\t\tuser-select: none;\n\t\t}\n\n\t\t&::before {\n\t\t\tdisplay: none !important;\n\t\t}\n\t}\n\n\t&__preview {\n\t\tdisplay: block;\n\t\toverflow: hidden;\n\t\t// Stretch so all entries are the same width\n\t\tflex: 1 1;\n\t\twidth: var(--width);\n\t\tmin-height: var(--height);\n\t\tmax-height: var(--height);\n\t\tpadding: 0;\n\t\tborder: var(--border) solid var(--color-border);\n\t\tborder-radius: var(--border-radius-large);\n\n\t\tinput:checked + label > & {\n\t\t\tborder-color: var(--color-primary);\n\t\t}\n\n\t\t&--failed {\n\t\t\t// Make sure to properly center fallback icon\n\t\t\tdisplay: flex;\n\t\t}\n\t}\n\n\t&__image {\n\t\tmax-width: 100%;\n\t\tbackground-color: var(--color-main-background);\n\n\t\tobject-fit: cover;\n\t}\n\n\t// Failed preview, fallback to mime icon\n\t&__preview--failed &__image {\n\t\twidth: calc(var(--margin) * 8);\n\t\t// Center mime icon\n\t\tmargin: auto;\n\t\tbackground-color: transparent !important;\n\n\t\tobject-fit: initial;\n\t}\n\n\t&__title {\n\t\toverflow: hidden;\n\t\t// also count preview border\n\t\tmax-width: calc(var(--width) + 2*2px);\n\t\tpadding: var(--margin);\n\t\twhite-space: nowrap;\n\t\ttext-overflow: ellipsis;\n\t}\n}\n\n"],sourceRoot:""}]);const s=o},19994:(t,e,i)=>{i.d(e,{Z:()=>s});var n=i(87537),a=i.n(n),r=i(23645),o=i.n(r)()(a());o.push([t.id,".app-navigation[data-v-622bb1e3] .app-navigation-entry-icon{background-repeat:no-repeat;background-position:center}.app-navigation>ul.app-navigation__list[data-v-622bb1e3]{padding-bottom:var(--default-grid-baseline, 4px)}.app-navigation-entry__settings[data-v-622bb1e3]{height:auto !important;overflow:hidden !important;padding-top:0 !important;flex:0 0 auto}","",{version:3,sources:["webpack://./apps/files/src/views/Navigation.vue"],names:[],mappings:"AAEA,4DACC,2BAAA,CACA,0BAAA,CAGD,yDAEC,gDAAA,CAGD,iDACC,sBAAA,CACA,0BAAA,CACA,wBAAA,CAEA,aAAA",sourcesContent:["\n// TODO: remove when https://github.com/nextcloud/nextcloud-vue/pull/3539 is in\n.app-navigation::v-deep .app-navigation-entry-icon {\n\tbackground-repeat: no-repeat;\n\tbackground-position: center;\n}\n\n.app-navigation > ul.app-navigation__list {\n\t// Use flex gap value for more elegant spacing\n\tpadding-bottom: var(--default-grid-baseline, 4px);\n}\n\n.app-navigation-entry__settings {\n\theight: auto !important;\n\toverflow: hidden !important;\n\tpadding-top: 0 !important;\n\t// Prevent shrinking or growing\n\tflex: 0 0 auto;\n}\n"],sourceRoot:""}]);const s=o},74502:(t,e,i)=>{i.d(e,{Z:()=>s});var n=i(87537),a=i.n(n),r=i(23645),o=i.n(r)()(a());o.push([t.id,".templates-picker__form[data-v-55dd9121]{padding:calc(var(--margin)*2);padding-bottom:0}.templates-picker__form h2[data-v-55dd9121]{text-align:center;font-weight:bold;margin:var(--margin) 0 calc(var(--margin)*2)}.templates-picker__list[data-v-55dd9121]{display:grid;grid-gap:calc(var(--margin)*2);grid-auto-columns:1fr;max-width:calc(var(--fullwidth)*6);grid-template-columns:repeat(auto-fit, var(--fullwidth));grid-auto-rows:1fr;justify-content:center}.templates-picker__buttons[data-v-55dd9121]{display:flex;justify-content:space-between;padding:calc(var(--margin)*2) var(--margin);position:sticky;bottom:0;background-image:linear-gradient(0, var(--gradient-main-background))}.templates-picker__buttons button[data-v-55dd9121],.templates-picker__buttons input[type=submit][data-v-55dd9121]{height:44px}.templates-picker[data-v-55dd9121] .modal-container{position:relative}.templates-picker__loading[data-v-55dd9121]{position:absolute;top:0;left:0;justify-content:center;width:100%;height:100%;margin:0;background-color:var(--color-main-background-translucent)}","",{version:3,sources:["webpack://./apps/files/src/views/TemplatePicker.vue"],names:[],mappings:"AAEC,yCACC,6BAAA,CAEA,gBAAA,CAEA,4CACC,iBAAA,CACA,gBAAA,CACA,4CAAA,CAIF,yCACC,YAAA,CACA,8BAAA,CACA,qBAAA,CAEA,kCAAA,CACA,wDAAA,CAEA,kBAAA,CAEA,sBAAA,CAGD,4CACC,YAAA,CACA,6BAAA,CACA,2CAAA,CACA,eAAA,CACA,QAAA,CACA,oEAAA,CAEA,kHACC,WAAA,CAKF,oDACC,iBAAA,CAGD,4CACC,iBAAA,CACA,KAAA,CACA,MAAA,CACA,sBAAA,CACA,UAAA,CACA,WAAA,CACA,QAAA,CACA,yDAAA",sourcesContent:["\n.templates-picker {\n\t&__form {\n\t\tpadding: calc(var(--margin) * 2);\n\t\t// Will be handled by the buttons\n\t\tpadding-bottom: 0;\n\n\t\th2 {\n\t\t\ttext-align: center;\n\t\t\tfont-weight: bold;\n\t\t\tmargin: var(--margin) 0 calc(var(--margin) * 2);\n\t\t}\n\t}\n\n\t&__list {\n\t\tdisplay: grid;\n\t\tgrid-gap: calc(var(--margin) * 2);\n\t\tgrid-auto-columns: 1fr;\n\t\t// We want maximum 5 columns. Putting 6 as we don't count the grid gap. So it will always be lower than 6\n\t\tmax-width: calc(var(--fullwidth) * 6);\n\t\tgrid-template-columns: repeat(auto-fit, var(--fullwidth));\n\t\t// Make sure all rows are the same height\n\t\tgrid-auto-rows: 1fr;\n\t\t// Center the columns set\n\t\tjustify-content: center;\n\t}\n\n\t&__buttons {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tpadding: calc(var(--margin) * 2) var(--margin);\n\t\tposition: sticky;\n\t\tbottom: 0;\n\t\tbackground-image: linear-gradient(0, var(--gradient-main-background));\n\n\t\tbutton, input[type='submit'] {\n\t\t\theight: 44px;\n\t\t}\n\t}\n\n\t// Make sure we're relative for the loading emptycontent on top\n\t::v-deep .modal-container {\n\t\tposition: relative;\n\t}\n\n\t&__loading {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tjustify-content: center;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tmargin: 0;\n\t\tbackground-color: var(--color-main-background-translucent);\n\t}\n}\n\n"],sourceRoot:""}]);const s=o}},n={};function a(t){var e=n[t];if(void 0!==e)return e.exports;var r=n[t]={id:t,loaded:!1,exports:{}};return i[t].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=i,e=[],a.O=(t,i,n,r)=>{if(!i){var o=1/0;for(c=0;c<e.length;c++){i=e[c][0],n=e[c][1],r=e[c][2];for(var s=!0,l=0;l<i.length;l++)(!1&r||o>=r)&&Object.keys(a.O).every((t=>a.O[t](i[l])))?i.splice(l--,1):(s=!1,r<o&&(o=r));if(s){e.splice(c--,1);var d=n();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[i,n,r]},a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var i in e)a.o(e,i)&&!a.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),a.j=2181,(()=>{a.b=document.baseURI||self.location.href;var t={2181:0};a.O.j=e=>0===t[e];var e=(e,i)=>{var n,r,o=i[0],s=i[1],l=i[2],d=0;if(o.some((e=>0!==t[e]))){for(n in s)a.o(s,n)&&(a.m[n]=s[n]);if(l)var c=l(a)}for(e&&e(i);d<o.length;d++)r=o[d],a.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return a.O(c)},i=self.webpackChunknextcloud=self.webpackChunknextcloud||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),a.nc=void 0;var r=a.O(void 0,[7874],(()=>a(47320)));r=a.O(r)})();
//# sourceMappingURL=files-main.js.map?v=6e7f7e1112454758459e